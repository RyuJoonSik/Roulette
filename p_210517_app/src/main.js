!function(){"use strict";var t=function(t){var e=!0;return"string"!=typeof t&&(e=!1,console.log("is not String.")),e},e=function(t){var e=!0;return"number"!=typeof t&&(e=!1,console.log("is not Number.")),e},i={setHTML:function(){var t=document.createElement("section");t.className="wrapper",t.innerHTML='\n      <ul id="districtList" class="main-district">\n      </ul>\n      <article id="roulette" class="roulette">\n        <canvas id="canvas" class="roulette--canvas">대체 텍스트 입니다.</canvas>\n        <button  id="start" class="roulette--button">\n          <span>START</span>\n        </button>\n      </article>\n      <ul id="recordList" class="record">\n      </ul>\n    ',"prepend"in Element?document.body.prepend(t):document.body.insertBefore(t,document.body.firstChild)},createEl:function(e){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t(e)&&t(n))switch(e){case"LI":return(i=document.createElement("li")).className="main-district--list",i;case"STRONG":return(i=document.createElement("strong")).className="main-district--name",i.innerText=n,i;case"EM":return(i=document.createElement("em")).className="main-district--number",i;case"UL":return(i=document.createElement("ul")).className="sub-district--unchecked",i;case"subLI":return(i=document.createElement("li")).className="sub-district--list",i.innerText=n,i;default:console.log("Undefined")}else console.log("WRONG TYPE")},addList:function(){function t(t){if(function(t){var e=!0;return"object"!=typeof t&&(e=!1,console.log("is not Object.")),e}(t)){var e=document.createDocumentFragment();for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var a=i.createEl("LI"),s=i.createEl("STRONG",n),r=i.createEl("EM"),o=i.createEl("UL"),l=t[n];"append"in Element?a.append(s,r):(a.appendChild(s),a.appendChild(r));for(var c=0;c<l.length;c++){var d=i.createEl("subLI",l[c]);o.appendChild(d)}a.appendChild(o),e.appendChild(a)}document.getElementById("districtList").appendChild(e)}}if("fetch"in window)fetch("./data/district.json").then((function(t){return t.json()})).then((function(e){return t(e)}));else{var e=new XMLHttpRequest;e.onreadystatechange=function(){4===e.readyState&&200===e.status&&t(JSON.parse(e.response))},e.open("GET","./data/district.json"),e.send()}}};function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,function(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}(t,e))}var s=new WeakMap,r=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,h=new WeakMap,u=function(){function i(t){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),s.set(this,{writable:!0,value:{canvasEl:null,ctx:null}}),r.set(this,{writable:!0,value:{radius:0,X:0,Y:0,dividedAngle:0}}),o.set(this,{writable:!0,value:{width:0,X:0,Y:0}}),l.set(this,{writable:!0,value:{passedTime:0,totalTime:0}}),c.set(this,{writable:!0,value:{spinnedAngle:0,totalSpin:0}}),d.set(this,{writable:!0,value:[]}),h.set(this,{writable:!0,value:["#fc5c65","#fd9644","#fed330","#26de81","#2bcbba","#45aaf2","#4b7bec","#a55eea"]}),e=!0,1!==t.nodeType&&(e=!1,console.log("is not Element node.")),!e||"CANVAS"!==t.nodeName)throw"Error ! 잘못된 데이터 타입 입니다.";var e;return i.instance?(console.log("생성된 객체가 이미 존재합니다."),i.instance):(a(this,s).canvasEl=t,a(this,s).ctx=a(this,s).canvasEl.getContext("2d"),a(this,r).X=a(this,s).canvasEl.width/2,a(this,r).Y=a(this,s).canvasEl.height/2,a(this,r).radius=a(this,s).canvasEl.width/2*.9,a(this,o).X=a(this,r).X,a(this,o).Y=a(this,r).Y-a(this,r).radius,a(this,o).width=.1*a(this,r).radius,i.instance=this,this)}var u,v;return u=i,(v=[{key:"setSize",value:function(){a(this,r).X=a(this,s).canvasEl.width/2,a(this,r).Y=a(this,s).canvasEl.height/2,a(this,r).radius=.9*a(this,r).X,a(this,o).X=a(this,r).X,a(this,o).Y=a(this,r).Y-a(this,r).radius,a(this,o).width=.1*a(this,r).radius}},{key:"drawArrow",value:function(){var t=a(this,s).ctx;t.beginPath(),t.fillStyle="#778ca3",t.moveTo(a(this,o).X,a(this,o).Y),t.lineTo(a(this,o).X+a(this,o).width,a(this,o).Y-a(this,o).width),t.lineTo(a(this,o).X-a(this,o).width,a(this,o).Y-a(this,o).width),t.fill()}},{key:"convertToRadian",value:function(t){if(e(t))return t*(Math.PI/180)}},{key:"setAngle",value:function(){a(this,r).dividedAngle=360/a(this,d).length}},{key:"setTime",value:function(){var t=10*Math.random()%3+2;a(this,l).totalTime=60*t,a(this,l).passedTime=0}},{key:"setSpin",value:function(){var t=10*Math.random()%2+2;a(this,c).totalSpin=360*t}},{key:"addDistrict",value:function(e){t(e)&&(a(this,d).push(e),this.setAngle())}},{key:"removeDistrict",value:function(e){if(t(e)){var i=a(this,d).indexOf(e);a(this,d).splice(i,1),this.setAngle()}}},{key:"easingOut",value:function(t,i,n,a){if(e(t)&&e(i)&&e(n)&&e(a))return t/=a,n*(--t*t*t+1)+i}},{key:"divideCircle",value:function(t){if(e(t)){var i=a(this,s).ctx,n=a(this,r),o=n.X,l=n.Y,d=n.dividedAngle;i.beginPath(),i.moveTo(o,l);var u=t*d+a(this,c).spinnedAngle,v=u+d;i.arc(o,l,a(this,r).radius,this.convertToRadian(u),this.convertToRadian(v)),i.strokeStyle="transparent",i.stroke(),i.fillStyle=a(this,h)[t%a(this,h).length],i.fill()}}},{key:"addText",value:function(t){if(e(t)){var i=a(this,s).ctx;i.font="20px serif",i.fillStyle="black",i.save();var n=a(this,r),o=n.dividedAngle,l=n.radius,h=n.X,u=n.Y,v=a(this,c).spinnedAngle,f=o/2+t*o+v,p=.9*l;i.translate(h+Math.cos(this.convertToRadian(f))*p,u+Math.sin(this.convertToRadian(f))*p);var g=t*o,m=90+g/2+(g+o)/2+v;i.rotate(this.convertToRadian(m)),i.fillText(a(this,d)[t],-i.measureText(a(this,d)[t]).width/2,0),i.restore()}}},{key:"drawRoulette",value:function(){a(this,s).ctx.clearRect(0,0,a(this,s).canvasEl.width,a(this,s).canvasEl.height),this.drawArrow();for(var t=0;t<a(this,d).length;t++)this.divideCircle(t),this.addText(t)}},{key:"spinRoulette",value:function(){var t=a(this,l),e=t.passedTime,i=t.totalTime;if(e<i){e=++a(this,l).passedTime;var n=a(this,c).totalSpin;a(this,c).spinnedAngle=this.easingOut(e,0,n,i),this.drawRoulette(),window.requestAnimationFrame(this.spinRoulette.bind(this))}else this.stopRoulette()}},{key:"stopRoulette",value:function(){var t=a(this,c).spinnedAngle,e=a(this,r).dividedAngle,i=t+90,n=Math.floor((360-i%360)/e);alert(a(this,d)[n])}}])&&n(u.prototype,v),i}();i.setHTML(),i.addList();var v=document.getElementById("canvas");v.width=v.parentNode.offsetWidth,v.height=v.parentNode.offsetWidth;var f=new u(v);f.drawArrow(),window.addEventListener("resize",(function(){v.width=v.parentNode.offsetWidth,v.height=v.parentNode.offsetWidth,f.setSize(),f.drawArrow(),f.drawRoulette()})),document.getElementById("districtList").addEventListener("click",(function(t){if("STRONG"===t.target.nodeName||"LI"===t.target.nodeName)if("STRONG"===t.target.nodeName){for(var e=t.target.nextSibling;"UL"!==e.nodeName;e=e.nextSibling);t.target.classList.toggle("main-district--name--checked"),e.classList.toggle("sub-district--unchecked")}else if(0===t.target.children.length){for(var i=t.target.parentNode;"EM"!==i.nodeName;i=i.previousSibling);t.target.classList.toggle("sub-district--list--checked"),t.target.classList.contains("sub-district--list--checked")?(f.addDistrict(t.target.innerText),f.drawRoulette(),i.innerText=""===i.innerText?"1":(parseInt(i.innerText)+1).toString()):(f.removeDistrict(t.target.innerText),f.drawRoulette(),i.innerText="1"===i.innerText?i.innerText="":(parseInt(i.innerText)-1).toString())}})),document.getElementById("start").addEventListener("click",(function(){f.setTime(),f.setSpin(),f.spinRoulette()}))}();